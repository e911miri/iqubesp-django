!function(a,b,c){"use strict";function g(){var a=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var b=0;b<a.length;b++)if(a[b]+"Hidden"in document)return a[b]+"Hidden";return null}function h(){var a=g();return a?document[a]:!1}function i(a){return 0===Object.keys(a).length}var e,f,d=a.event;e=d.special.debouncedresize={setup:function(){a(this).on("resize",e.handler)},teardown:function(){a(this).off("resize",e.handler)},handler:function(a,b){var c=this,g=arguments,h=function(){a.type="debouncedresize",d.dispatch.apply(c,g)};f&&clearTimeout(f),b?h():f=setTimeout(h,e.threshold)},threshold:100},Array.prototype.shuffle=function(){for(var b,c,a=this.length;a--;)b=Math.floor(Math.random()*a),c=this[a],this[a]=this[b],this[b]=c;return this};var j=a(b),k=b.Modernizr;a.GridRotator=function(b,c){this.$el=a(c),k.backgroundsize&&(this.$el.addClass("ri-grid-loading"),this._init(b))},a.GridRotator.defaults={rows:4,columns:10,w1024:{rows:3,columns:8},w768:{rows:3,columns:7},w480:{rows:3,columns:5},w320:{rows:2,columns:4},w240:{rows:2,columns:3},step:"random",maxStep:3,preventClick:!0,animType:"random",animSpeed:800,animEasingOut:"linear",animEasingIn:"linear",interval:3e3,slideshow:!0,onhover:!1,nochange:[]},a.GridRotator.prototype={_init:function(b){this.options=a.extend(!0,{},a.GridRotator.defaults,b),this._config()},_config:function(){var b=this,c={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};this.supportTransitions=k.csstransitions,this.supportTransforms3D=k.csstransforms3d,this.transEndEventName=c[k.prefixed("transition")]+".gridrotator",this.animTypes=this.supportTransforms3D?["fadeInOut","slideLeft","slideRight","slideTop","slideBottom","rotateLeft","rotateRight","rotateTop","rotateBottom","rotate3d"]:["fadeInOut","slideLeft","slideRight","slideTop","slideBottom"],this.animType=this.options.animType,"random"===this.animType||this.supportTransforms3D||-1!==a.inArray(this.animType,this.animTypes)||"showHide"===this.animType||(this.animType="fadeInOut"),this.animTypesTotal=this.animTypes.length,this.$list=this.$el.children("ul");var d=0,e=this.$list.find("img"),f=e.length;e.each(function(){var c=a(this),g=c.attr("src");a("<img/>").load(function(){++d,c.parent().css("background-image","url("+g+")"),d===f&&(e.remove(),b.$el.removeClass("ri-grid-loading"),b.$items=b.$list.children("li"),b.$itemsCache=b.$items.clone(),b.itemsTotal=b.$items.length,b.outItems=[],b._layout(function(){b._initEvents()}),b._start())}).attr("src",g)})},_layout:function(b){var c=this;this._setGridDim(),this.$list.empty(),this.$items=this.$itemsCache.clone().appendTo(this.$list);var d=this.$items.filter(":gt("+(this.showTotal-1)+")"),e=d.children("a");this.outItems.length=0,e.each(function(){c.outItems.push(a(this))}),d.remove();for(var f=document.defaultView?parseInt(document.defaultView.getComputedStyle(this.$el.get(0),null).width):this.$el.width(),g=Math.floor(f/this.columns),h=f-this.columns*Math.floor(g),i=0;i<this.rows;++i)for(var j=0;j<this.columns;++j){var k=this.columns*i+j,l=this.$items.eq(k);l.css({width:j<Math.floor(h)?g+1:g,height:g}),-1!==a.inArray(k,this.options.nochange)&&l.addClass("ri-nochange").data("nochange",!0)}this.options.preventClick&&this.$items.children().css("cursor","default").on("click.gridrotator",!1),b&&b.call()},_setGridDim:function(){var a=this.$el.width();switch(!0){case 240>a:this.rows=this.options.w240.rows,this.columns=this.options.w240.columns;break;case 320>a:this.rows=this.options.w320.rows,this.columns=this.options.w320.columns;break;case 480>a:this.rows=this.options.w480.rows,this.columns=this.options.w480.columns;break;case 768>a:this.rows=this.options.w768.rows,this.columns=this.options.w768.columns;break;case 1024>a:this.rows=this.options.w1024.rows,this.columns=this.options.w1024.columns;break;default:this.rows=this.options.rows,this.columns=this.options.columns}this.showTotal=this.rows*this.columns},_initEvents:function(){var b=this;j.on("debouncedresize.gridrotator",function(){b._layout()});var c=g();if(c){var d=c.replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(d,function(){b._visChange()})}!k.touch&&this.options.onhover&&b.$items.on("mouseenter.gridrotator",function(){var c=a(this);c.data("active")||c.data("hovered")||c.data("nochange")||(c.data("hovered",!0),b._replace(c))}).on("mouseleave.gridrotator",function(){a(this).data("hovered",!1)})},_visChange:function(){h()?clearTimeout(this.playtimeout):this._start()},_start:function(){this.showTotal<this.itemsTotal&&this.options.slideshow&&this._showNext()},_getAnimType:function(){return"random"===this.animType?this.animTypes[Math.floor(Math.random()*this.animTypesTotal)]:this.animType},_getAnimProperties:function(a){var h,b={},d={},e={},f={},g=this._getAnimType(),i=0;switch(g){case"showHide":h=0,f.opacity=0;break;case"fadeInOut":f.opacity=0;break;case"slideLeft":b.left=a.width(),e.left=0,f.left=-a.width();break;case"slideRight":b.left=-a.width(),e.left=0,f.left=a.width();break;case"slideTop":b.top=a.height(),e.top=0,f.top=-a.height();break;case"slideBottom":b.top=-a.height(),e.top=0,f.top=a.height();break;case"rotateLeft":h=this.options.animSpeed/2,b.transform="rotateY(90deg)",e.transform="rotateY(0deg)",i=h,f.transform="rotateY(-90deg)";break;case"rotateRight":h=this.options.animSpeed/2,b.transform="rotateY(-90deg)",e.transform="rotateY(0deg)",i=h,f.transform="rotateY(90deg)";break;case"rotateTop":h=this.options.animSpeed/2,b.transform="rotateX(90deg)",e.transform="rotateX(0deg)",i=h,f.transform="rotateX(-90deg)";break;case"rotateBottom":h=this.options.animSpeed/2,b.transform="rotateX(-90deg)",e.transform="rotateX(0deg)",i=h,f.transform="rotateX(90deg)";break;case"scale":h=this.options.animSpeed/2,b.transform="scale(0)",d.transform="scale(1)",e.transform="scale(1)",i=h,f.transform="scale(0)";break;case"rotateLeftScale":d.transform="scale(1)",h=this.options.animSpeed/2,b.transform="scale(0.3) rotateY(90deg)",e.transform="scale(1) rotateY(0deg)",i=h,f.transform="scale(0.3) rotateY(-90deg)";break;case"rotateRightScale":d.transform="scale(1)",h=this.options.animSpeed/2,b.transform="scale(0.3) rotateY(-90deg)",e.transform="scale(1) rotateY(0deg)",i=h,f.transform="scale(0.3) rotateY(90deg)";break;case"rotateTopScale":d.transform="scale(1)",h=this.options.animSpeed/2,b.transform="scale(0.3) rotateX(90deg)",e.transform="scale(1) rotateX(0deg)",i=h,f.transform="scale(0.3) rotateX(-90deg)";break;case"rotateBottomScale":d.transform="scale(1)",h=this.options.animSpeed/2,b.transform="scale(0.3) rotateX(-90deg)",e.transform="scale(1) rotateX(0deg)",i=h,f.transform="scale(0.3) rotateX(90deg)";break;case"rotate3d":h=this.options.animSpeed/2,b.transform="rotate3d( 1, 1, 0, 90deg )",e.transform="rotate3d( 1, 1, 0, 0deg )",i=h,f.transform="rotate3d( 1, 1, 0, -90deg )"}return{startInProp:b,startOutProp:d,endInProp:e,endOutProp:f,delay:i,animSpeed:h!=c?h:this.options.animSpeed}},_showNext:function(a){var b=this;clearTimeout(this.playtimeout),this.playtimeout=setTimeout(function(){var a=b.options.step,c=b.options.maxStep,d=1;c>b.showTotal&&(c=b.showTotal);for(var e="random"===a?Math.floor(Math.random()*c+d):Math.min(Math.abs(a),c),f=b._getRandom(e,b.showTotal),g=0;e>g;++g){var h=b.$items.eq(f[g]);if(h.data("active")||h.data("nochange"))return b._showNext(1),!1;b._replace(h)}b._showNext()},a||Math.max(Math.abs(this.options.interval),300))},_replace:function(b){b.data("active",!0);var c=this,d=b.children("a:last"),e={width:d.width(),height:d.height()};b.data("active",!0);var f=this.outItems.shift();this.outItems.push(d.clone().css("transition","none")),f.css(e).prependTo(b);var g=this._getAnimProperties(d);f.css(g.startInProp),d.css(g.startOutProp),this._setTransition(f,"all",g.animSpeed,g.delay,this.options.animEasingIn),this._setTransition(d,"all",g.animSpeed,0,this.options.animEasingOut),this._applyTransition(f,g.endInProp,g.animSpeed,function(){var b=a(this),d=g.animSpeed===c.options.animSpeed&&i(g.endInProp)?g.animSpeed:0;setTimeout(function(){c.supportTransitions&&b.off(c.transEndEventName),b.next().remove(),b.parent().data("active",!1)},d)},0===g.animSpeed||i(g.endInProp)),this._applyTransition(d,g.endOutProp,g.animSpeed)},_getRandom:function(a,b){for(var c=[],d=0;b>d;++d)c.push(d);return c.shuffle().slice(0,a)},_setTransition:function(a,b,c,d,e){setTimeout(function(){a.css("transition",b+" "+c+"ms "+d+"ms "+e)},25)},_applyTransition:function(b,c,d,e,f){var g=this;setTimeout(function(){a.fn.applyStyle=g.supportTransitions?a.fn.css:a.fn.animate,e&&g.supportTransitions&&(b.on(g.transEndEventName,e),f&&e.call(b)),e=e||function(){return!1},b.stop().applyStyle(c,a.extend(!0,[],{duration:d+"ms",complete:e}))},25)}};var l=function(a){b.console&&b.console.error(a)};a.fn.gridrotator=function(b){var c=a.data(this,"gridrotator");if("string"==typeof b){var d=Array.prototype.slice.call(arguments,1);this.each(function(){return c?a.isFunction(c[b])&&"_"!==b.charAt(0)?(c[b].apply(c,d),void 0):(l("no such method '"+b+"' for gridrotator instance"),void 0):(l("cannot call methods on gridrotator prior to initialization; attempted to call method '"+b+"'"),void 0)})}else this.each(function(){c?c._init():c=a.data(this,"gridrotator",new a.GridRotator(b,this))});return c}}(jQuery,window);